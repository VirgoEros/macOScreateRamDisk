(* 
bit.ly/é±«é°°macOS_RamDisk 
GitHub.com/VirgoEros/macOScreateRamDisk/blob/master/AppleScript 
*)
---------------------------âˆ RamDisk âˆ----------------------------------------ON. 
global RamDiskOption, createRamDisk, OpenScript, errmsg, errnbr
global createRamDisk, RamDiskSize, RamDiskName, RamDiskImg, RamDisk, RamDiskShellCmd, TerminalNotifier, isDone, itemPath, itemProgress, errmsg, errnbr
global OpenScript, OpenAppScript, TerminalNotifier, errmsg, errnbr

on run
	try
		tell application "Finder" to set {button returned:RamDiskOption} to Â¬
			display dialog ("è«‹åš«é±«çš„æ²å¥³é°°é¸æ“‡ é±«é°°è£¸è»Ÿ é¸é …å”·ğŸ’‹") buttons Â¬
				{"é°ä²RamDisk", "é–‹å•Ÿé±«é°°RamDiskè…³æœ¬", "é€€å‡º"} with title Â¬
				{"é±«é°°RamDisk"}
		if RamDiskOption is "é°ä²RamDisk" then run script createRamDisk
		if RamDiskOption is "é–‹å•Ÿé±«é°°RamDiskè…³æœ¬" then run script OpenScript
		if RamDiskOption is "é€€å‡º" then continue quit
	on error errmsg number errnbr
		if errnbr = -128 then continue quit
		continue quit
	end try
end run

script createRamDisk
	try
		tell application "Finder"
			set RamDiskSize to Â¬
				display dialog {" 
è«‹åš«é±«çš„é°›é°‡é±®ç¾é±ºæ²å¥³é°°é°é­æ‰€éœ€ RamDisk Gæ•¸ å”·ğŸ’‹ 
é»˜èª 4G å”·ğŸ’‹"} default answer ("4") buttons Â¬
					{"å—¯å“¼ã€‚ã€‚å¥½çš„å”·ğŸ’‹"} default button ("å—¯å“¼ã€‚ã€‚å¥½çš„å”·ğŸ’‹")
			set RamDiskSize to {text returned of the result}
			if RamDiskSize is "" then return continue quit
			set RamDiskName to Â¬
				display dialog {" 
è«‹åš«é±«çš„é°›é°‡é±®ç¾é±ºæ²å¥³é°°é°é­RamDiskåç¨±å”·ğŸ’‹ 
é»˜èªğ©»Ÿ é±«é°°RamDisk å”·ğŸ’‹"} default answer (quoted form of "é±«é°°RamDisk") buttons Â¬
					{"å—¯å“¼ã€‚ã€‚å¥½çš„å”·ğŸ’‹"} default button ("å—¯å“¼ã€‚ã€‚å¥½çš„å”·ğŸ’‹")
			set RamDiskName to {text returned of the result}
			if RamDiskName is "" then return continue quit
			set RamDiskSize to {RamDiskSize * 1024 * 2048}
			do shell script {"hdiutil attach -nomount ram://" & RamDiskSize}
			set RamDiskImg to {the result}
			set RamDisk to {the last text item of RamDiskImg}
			set RamDiskShellCmd to {" newfs_hfs -v " & RamDiskName & " -s " & RamDisk as text}
			do shell script (RamDiskShellCmd)
			do shell script {" diskutil mount " & RamDisk}
			{do shell script (" 
cd /Volumes/" & RamDiskName & " ; 
mkdir -p _æ‡‰ç”¨å¿«é¯« ä¸‹è¼‰ æ–‡ä»¶ éŸ³æ¨‚ åœ–ç‰‡ å½±ç‰‡ ; 
cd ~/Library/Caches ;
rm -rf Google ; 
ln -fs /Volumes/" & RamDiskName & "/_æ‡‰ç”¨å¿«é¯« ~/Library/Caches/Google ; 
cd ;") with administrator privileges}
		end tell
		set isDone to false
		set itemPath to (RamDiskName)
		set itemProgress to "ps ax | grep -v grep | grep " & itemPath
		repeat while isDone is false
			try
				do shell script itemProgress
				if the result contains itemPath then
					delay 1
				else
					set isDone to true
				end if
			on error
				set isDone to true
			end try
		end repeat
		if isDone is true then
			display notification with title ("RamDiskå·²é°ä²é°³å”·ğŸ’‹")
			continue quit
		end if
	on error errmsg number errnbr
		if errnbr = -128 then continue quit
		continue quit
	end try
end script
------------------------ é–‹å•Ÿé±«é°°RamDiskè…³æœ¬ ------------------------ON. 
script OpenScript
	try
		set OpenAppScript to POSIX path of (path to me as text) & ("Contents/Resources/Scripts/main.scpt")
		set OpenAppScript to quoted form of OpenAppScript
		do shell script ("open " & OpenAppScript)
		display notification with title ("è…³æœ¬å·²é–‹å•Ÿé°³å”·ğŸ’‹")
		continue quit
	on error errmsg number errnbr
		if errnbr = -128 then continue quit
		continue quit
	end try
end script
------------------------------âˆ é±«é°°RamDisk âˆ----------------------------------------END. 


-- 
